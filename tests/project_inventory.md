üìë PROJECT_INVENTORY.mdProject: VerbaPostVersion: v3.5.3 (Hardened)Last Updated: December 22, 2025System Status: ‚úÖ OPERATIONAL1. Core Architecture: Router-Controller-EngineVerbaPost is a modular Streamlit application. It follows a strict separation of concerns to maintain stability and prevent feature loss.Router (main.py): The central gatekeeper. Manages payment fulfillment, security, and global state.Controllers (ui_*.py): UI-specific modules managing user journeys for Standard, Legacy, and Heirloom tiers.Engines (*_engine.py, mailer.py): Standalone logic units for APIs (Stripe, OpenAI, PostGrid) and database operations.2. Master File ManifestüèóÔ∏è Infrastructure & RoutingFileVersionKey Featuresmain.pyv3.5.3Idempotency-first payment processing; global routing.database.pyv3.3.0Unified SQLAlchemy models; dictionary-casting for safety.module_validator.pyv3.5.0Pre-flight system health checks.üñ•Ô∏è UI Controllers (Frontend)FileVersionKey Featuresui_splash.pyv3.5.3Professional minimalist landing; fixed legal navigation.ui_heirloom.pyv3.5.3Family Archive; atomic credit logic; fixed paywall HTML.ui_main.pyv3.5.1Standard Store; Campaign (CSV) mode; audio dictation.ui_legacy.pyv3.4.0Accessibility-first "End of Life" correspondence.ui_legal.pyv3.5.1Standardized Terms and Privacy rendering.‚öôÔ∏è Backend Engines (Logic)FileVersionKey Featuresai_engine.pyv3.5.3Transcription; robust E.164 phone normalization.mailer.pyv3.5.3PostGrid fulfillment; security log masking.payment_engine.pyv3.4.0Stripe Checkout and session verification.letter_format.pyv3.3.0PDF typesetting with custom font safety fallbacks.3. Automated Safety Inspector (CI/CD)The system is protected by an automated verification suite that runs on every GitHub upload.Test Suite (tests/test_hardening.py): Automates checks for phone normalization, credit atomicity, and log sanitization.Automation Robot (.github/workflows/verify_hardening.yml): Triggers the Safety Inspector automatically.4. Mandatory Development ConstraintsZero-Refactor Policy: No code shortening or "cleaning." AI must provide the entire file with integrated changes.State Triad Requirement: Any changes to ui_splash must verify the Trigger, Loader, and Router for auxiliary pages.Financial Atomicity: External API fulfillment (Mailing) must always succeed before internal database updates (Credits) are performed.
